<section class="main-content">
  <div class="container">
    <h2 class="page-title">Add New Loan</h2>
    <div class="card">
      <div class="card-body p-lg">
        <div class="row">
          <div class="col-md-6">
                    
            <section class="profile-content">
              <% if @error %>
                <div class="col-md-6 alert alert-danger" role="alert"><%= @error %></div>
              <% end %>
              <h5 class="primary-header">New Loan </h5>
              <%= form_with url: admin_add_new_loan_path, model: @loan, id: 'contribution_form' do |f|%>
                <table class="table money-content">
                  <tbody>
                    <tr>
                      <td>Select Loanee</td>
                      <td class="text-right">
                        <%= f.select(:profile_id, @profile.collect {|p| [ p.firstname + " " + p.lastname, p.id ] }, { 
                          include_blank: "Select Loanee" }, id: "profile_id", class: "custom-select form-control", required: "required") %>
                      </td>
                    </tr>
                    <tr>
                      <td>Amount in &#8358;</td>
                      <td class="text-right">
                        <%= f.text_field :amount, id: "loan-amount", class: 'form-control', placeholder: "Amount" %>
                      </td>
                    </tr>
                    <tr>
                      <td>Loan Type</td>
                      <td class="text-right">
                        <%= f.select :loan_type_id,
                          options_from_collection_for_select(@loan_types, "id", "name", @loan[:loan_type_id]),
                          { 
                            include_blank: "Select Loan Type" 
                          },
                          {
                            class: "custom-select form-control",
                            id:"loan_type",
                            required: true,
                          }
                        %>
                      </td>
                    </tr>
                    <tr>
                      <td>Guarantor 1</td>
                      <td class="text-right">
                        <%= f.select(:guarantor_one_id, @profile.collect {|p| [ p.firstname + " " + p.lastname, p.id ] }, { 
                          include_blank: "Guarantor 1" }, id: "guarantor_one_id", class: "custom-select form-control", required: "required") %>
                      </td>
                    </tr>
                    <tr>
                      <td>Guarantor 2</td>
                      <td class="text-right">
                        <%= f.select(:guarantor_two_id, @profile.collect {|p| [ p.firstname + " " + p.lastname, p.id ] }, { 
                          include_blank: "Guarantor 2" }, id: "guarantor_two_id", class: "custom-select form-control", required: "required") %>
                      </td>
                    </tr>

                     <%# Upload Current Payslip %>
                      <tr>
                        <td>Upload Current Payslip</td>
                        <td class="text-right">
                          <%= f.file_field :payslip %>
                        </td>
                      </tr>

                      <%# Upload ID Card %>
                      <tr>
                        <td>Upload ID Card</td>
                        <td class="text-right">
                          <%= f.file_field :id_card %>
                        </td>
                      </tr>

                    <tr>
                      <td colspan=2 align="center">
                        <div class="col-sm-12">
                          <%= f.submit "Save Loan", class:"btn btn-secondary btn-lg" %>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              <% end %>
            </section>
          </div>

          <div class="col-md-6">
            <div class="row">
              <div class="col-sm-12">
                <h5 class="primary-header">All Loans Repayments </h5>
                <table class="table table-striped table-money">
                  <thead>
                    <tr>
                      <th class="text-center" width="15%">#</th>
                      <th width="55%">Date</th>
                      <th class="text-center" width="30%">Amount</th>
                    </tr>
                  </thead>
                </table>
                <div class="table-money-holder">
                  <table class="table table-striped table-money">
                    <tbody>
                      <% @recent_loans_repayment.each_with_index do |loan_repayment, index| %>
                        <tr>
                          <th scope="row" class="text-center" width="15%"><%= index+1 %></th>
                          <td width="55%"><%= loan_repayment.month %> <%= loan_repayment.year %></td>
                          <td class="text-center" width="30%"><%= loan_repayment.amount %></td>
                        </tr>
                      <% end %>
                    </tbody>
                  </table>
                </div>
                <table class="table table-striped table-money">
                  <thead>
                    <tr>
                      <th width="70%" colspan="2">Total</th>
                      <th class="text-center" width="30%"><%= @total_loan_repayment %></th>
                    </tr>
                  </thead>
                </table>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</section>